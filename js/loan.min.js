var isTryLoan=!1,$loanButton=document.getElementById("loan-button");document.addEventListener("DOMContentLoaded",function(){$loanButton.addEventListener("click",initLoan)},!1);function initLoan(){$loanButton.classList.add("processing");"file:"!==window.location.protocol&&(isTrial()?loanRequest(tryLoan):loanRequest(loanError))}function isTrial(){try{var a;return"yes"===(null!=(a=$loginData.trial)?a:"")}catch(b){return!0}}function isLoggedIn(a){var b;return"yes"===(null!=(b=a.logged_in)?b:"")}
function loanSuccess(a){var b=document.getElementById("loan");setTimeout(function(){b.classList.remove("active");b.style.display="none"},500);onLoggedIn(a);$loanButton.classList.remove("processing")}
function tryLoan(a){console.log(a);if(!isLoggedIn(a))return loanError(a);var b=parseInt(a.session_time_left_secs),c=parseInt(a.remain_bytes_total)+parseInt(a.bytes_in);console.log(b);if(999999999122456<=c){if(isTryLoan)return loanError(a);setTimeout(function(){loanRequest(tryLoan);isTryLoan=!0},1E3*b)}else loanSuccess(a)}
function loanRequest(a){var b=isTryLoan?"/status?var=callBack":"/login?username=T-".concat($loginData.mac,"&var=callBack"),c=new XMLHttpRequest;c.open("GET",b,!0);c.onreadystatechange=function(){if(4===this.readyState){var d=this.responseText;try{var e=JSON.parse(d);void 0!==a&&a(e)}catch(f){}}};c.send()}
function loanError(a){console.log("error");console.log(a);var b=document.getElementById("error");"onLoginError"===a.action&&isTrial()&&"your traffic limit is reached"!==a.error_orig?b.innerText="لايمكنك اخذ السلفة اذا لم تستخدم 5 كروت او اكثر بهذا الجهاز من بعد تركيب الخدمة":"onLoginError"===a.action&&/invalid username|not found/.test(a.error)?b.innerText="خدمة سلفني متوقفة في الوقت الحالي":b.innerText="لايمكنك الاستلاف اكثر من مرة واحدة .. سيتم فتح السلفة مجددا حال سدادك للسلفة الاولى";showErrorPopup();
$loanButton.classList.remove("processing")};
